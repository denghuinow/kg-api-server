# 默认配置（无敏感信息），可按需修改
server:
  host: "0.0.0.0"
  port: 8021
  cors_allow_origins: ["*"]
  api_key: "sk-Fu1FjFwsCdEcRutZXemGfw5K3FZfjs7ffWIk4G0WZ78YMS1v"
neo4j:
  uri: "neo4j://172.16.15.249:7687"
  username: "neo4j"
  password: "password"
  database: "neo4j"

retention:
  max_versions: 10
  enable_cleanup: true

query:
  default_limit_nodes: 500
  default_limit_edges: 1000
  default_depth: 2
  max_seed_nodes: 30

hooks:
  module: "server.utils.hooks_db"
  full: "get_full_data"
  incremental: "get_incremental_data"
  connection_string: "postgresql://vector_user:vector_pass@172.16.15.236:5432/data_integration"
  # connection_string_env: HOOKS_DB_CONNECTION_STRING  # 可选：从环境变量读取
  table_name: "knowledge_chunks_kg_test"

deps:
  # 强制优先使用仓库内的 itext2kg 代码（用于本地联调/开发），避免误用 .venv/site-packages 里的旧版本
  local_itext2kg_path: "../itext2kg"
output:
  language: zh
  entity_name_mode: source
  relation_name_mode: source
  # 当模型未给出关系名或给出空白时的兜底关系名（用于诊断与后续收敛）
  relation_fallback_name: related_to

ontology:
  auto_entity_label:
    # 使用大模型对所有实体统一归类；允许“自由发明新类型”
    enabled: true
    allow_new_labels: true
    # 归类结果必须输出中文通用粗粒度类别；无法判断时使用 unknown_label
    unknown_label: unknown
    # 若为 true，则 start/end 任一端 label=unknown 的关系会被丢弃（更严格、更少误合并）
    drop_unknown: false
    # 额外提示：新增“团队”等类型
    hints:
      - 团队
    # 给模型的上下文（每个实体最多附带多少条关联 atomic facts）
    max_facts_per_entity: 6
    # 每批次最多处理多少个实体（避免单次请求过大）
    batch_size: 80

atom:
  ent_threshold: 0.92
  rel_threshold: 0.92
  entity_name_weight: 0.8
  entity_label_weight: 0.2
  max_workers: 8
  debug:
    # 开启后会在构图时统计 Relationship.name 为空的比例，并输出少量样例（截断 atomic_fact）
    log_empty_relation_name: true
    relation_name_sample_size: 5
  matching:
    require_same_entity_label: true
    rename_relationship_by_embedding: false

llm:
  api_key: "sk-qPCtivhoJmQj91fsGEljHybU9Ua2Tor3AaCnk5WHS3m810KY"
  api_base_url: "https://oneapi.wchat.cc/v1"
  # model: "Qwen/Qwen3-30B-A3B-Instruct-2507"
  model: "qwen3-235b-a22b-instruct-2507"
  max_tokens: 8192
  temperature: 0
  max_retries: 0
  rate_limit:
    rpm: 120
    tpm: 200000
  concurrency:
    max_in_flight: 8
  retry:
    max_retries: 6
    initial_backoff_s: 1.0
    max_backoff_s: 30.0
    backoff_multiplier: 2.0

embeddings:
  api_key: "sk-qPCtivhoJmQj91fsGEljHybU9Ua2Tor3AaCnk5WHS3m810KY"
  api_base_url: "https://oneapi.wchat.cc/v1"
  model: "Qwen/Qwen3-Embedding-8B"
  rate_limit:
    rpm: 300
    tpm: 600000
  concurrency:
    max_in_flight: 16
  retry:
    max_retries: 6
    initial_backoff_s: 1.0
    max_backoff_s: 30.0
    backoff_multiplier: 2.0

task:
  timeout_s: 0

logging:
  level: "INFO"
  # 默认关闭 OpenAI/httpx 的每次请求 200 OK 日志
  silence_http_requests: true
